service: redirect-api

provider:
  name: aws
  runtime: python3.6
  region: us-east-1
  iam:
    role: LambdaFunctionRole
  apiGateway:
    binaryMediaTypes:
      - 'multipart/form-data'
      - 'application/pdf'
  logs:
    restApi:
      level: INFO
      roleManagedExternally: true
  lambdaHashingVersion: '20201221'
  vpc:
    securityGroupIds:
      - ${ssm:/eregulations/aws/securitygroupid}
    subnetIds:
      - ${ssm:/account_vars/vpc/subnets/private/a/id}
      - ${ssm:/account_vars/vpc/subnets/private/b/id}
  deploymentBucket:
      blockPublicAccess: true
  tracing:
    apiGateway: true

functions:
  redirectFunction:
    handler: redirect_lambda.handler
    timeout: 30
    events:
      - http: ANY /redirect
      - http: ANY /redirect/{proxy+}
custom:
  wsgi:
    app: handler.application
    packRequirements: false

plugins:
  - serverless-wsgi
